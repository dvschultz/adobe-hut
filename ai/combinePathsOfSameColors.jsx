#target illustrator// before running script: make sure file Pathfinder-Actions.aia in the /actions folder has been loaded into Illustrator// todo: load file dynamically (this threw errors for some reason: http://stackoverflow.com/questions/42912799/can-i-execute-pathfinder-crop-from-the-pathfinder-panel-and-not-the-effects)var doc = app.activeDocument;var selectedPaths;if ( app.documents.length > 0 && doc.pathItems.length > 0 ) {        // loop thru all shapes    var i = 0;    while(i < doc.pathItems.length-1) {                // get first shape; select it        pathRef = doc.pathItems[i];        pathRef.selected = true;                // select all same colors        // http://chuwa.iobb.net/tech/illustrator-cc2014-menu-comman.html        app.executeMenuCommand('Find Fill Color menu item');        // check if selection contains more than 1 shape        selectedPaths = doc.selection;        if(selectedPaths.length > 1) {                        // if so combine them via pathfinder            // see http://stackoverflow.com/questions/42912799/can-i-execute-pathfinder-crop-from-the-pathfinder-panel-and-not-the-effects            // to do pathfinder trick            app.doScript("add", "Pathfinder-Actions", false);           }            //deselect paths: this makes sure we don’t add mismatched color paths together        doc.selection = null;                //iterate        i++;    }}